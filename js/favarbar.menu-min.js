var fs_current_favor_item;var fs_favor_prog_ary;function showNewFavorItem(){$("#favorcoverbarmenu").show();$("#favornewitemlayer").show()}function hideNewFavorItem(){$("#favorcoverbarmenu").hide();$("#favornewitemlayer").hide()}function addBlankMenuItem(a){let seqno=a.attr("seqno");$blank=$('<a href="javascript:void(0);" class="tile fa-box-title fav-blank" title="New Favorite" seqno="'+seqno+'"><div class="icon"><img class="fa fa-app-image" src="'+CDN_URL+'/img/apps/fs_icon.png" /></div><span class="title">Add New</span></a>');$blank.click(function(b){b.stopPropagation();fs_current_favor_item=$(this);showNewFavorItem()});$blank.insertBefore(a)}function setupOpenLink(a){let pid=a.attr("pid");let url=a.attr("url");if(pid&&pid!=""){a.click(function(b){open_page(pid,url,null,null,a)})}}function setupTodo(a){if(!CDN_URL){CDN_URL=""}let $del=$('<li><img src="'+CDN_URL+'/img/delete_icon.png" title="Delete" width="25px" height="25px"/></li>');$del.click(function(b){b.stopPropagation();let fs_user=$("#main_user").val();let fs_seqno=a.attr("seqno");let fs_prog=a.attr("pid");if(fs_prog&&fs_prog!=""){let authtoken=getAccessorToken();jQuery.ajax({url:API_URL+"/api/menu/remove",type:"POST",data:{userid:fs_user,programid:fs_prog,seqno:fs_seqno},headers:{authtoken:authtoken},dataType:"html",contentType:defaultContentType,error:function(e,c,d){submitFailure(e,c,d)},success:function(d,c,e){}})}addBlankMenuItem(a);a.remove()});let $item=$('<ul class="todo" style="display:none;"></ul>').append($del);a.append($item);a.hover(function(){$item.show()},function(){$item.hide()})}function insertNewFavorMenuItem(d,c,b,a){if(!c||!b||!a){return}let fs_seqno=d.attr("seqno");let fs_user=$("#main_user").val();let $newlink=$('<a href="javascript:void(0);" class="tile fa-box-title fav-app" pid="'+c+'" seqno="'+fs_seqno+'"><div class="icon"><img class="fa fa-app-image" src="'+CDN_URL+"/img/apps/"+a+'" /></div><span class="title">'+b+"</span></a>");if(c&&c!=""){let authtoken=getAccessorToken();jQuery.ajax({url:API_URL+"/api/menu/insert",type:"POST",data:{userid:fs_user,programid:c,seqno:fs_seqno},headers:{authtoken:authtoken},dataType:"html",contentType:defaultContentType,error:function(g,e,f){submitFailure(g,e,f)},success:function(f,e,g){$newlink.insertBefore(d);setupOpenLink($newlink);setupTodo($newlink);setupContextMenu("favorbarmenu","favorcontextmenu",$newlink);d.remove()}})}}function bindingOnFavorMenu(){$("a",$("#favorbarmenu")).each(function(a,b){let alink=$(b);if(!alink.is(".fav-app")){alink.click(function(c){c.stopPropagation();fs_current_favor_item=alink;showNewFavorItem()})}else{setupOpenLink(alink);setupTodo(alink)}});setupContextMenu("favorbarmenu","favorcontextmenu")}function addNewFavorMenuItem(b,a){let favorbar=$("#favorbarmenu");let len=favorbar.find("a").length;if(len>14){favorbar.find("a:eq(0)").remove()}let $newlink=$('<a href="javascript:void(0);" class="tile fa-box-title"><div class="icon"><i class="fa fa-university"></i></div><span class="title">'+b+"</span></a>");favorbar.append($newlink);if(a){a.stopPropagation()}if(!$("#favormenuitem").is(".open")){$("#favormenuitemlink").trigger("click")}}function inputNewFavorMenuItem(a){if(a){a.stopPropagation()}bootbox.prompt({title:"Favorite Menu",value:"Institute",callback:function(b){if(b&&b!=""){addNewFavorMenuItem(b)}}})}function setupContextMenu(a,c,b){}function load_prog_item(){let authtoken=getAccessorToken();let fs_user=$("#main_user").val();jQuery.ajax({url:API_URL+"/api/menu/prog",type:"POST",data:{userid:fs_user},headers:{authtoken:authtoken},dataType:"json",contentType:defaultContentType,error:function(c,a,b){},success:function(b,a,c){fs_favor_prog_ary=b.body.dataset;prepareOptions(fs_favor_prog_ary,"progcategory",$("#favorprogitem").empty())}})}$(function(){$("#favornewitem").click(function(a){a.stopPropagation();hideNewFavorItem();if(fs_current_favor_item){let fs_prog=$("#favorprogitem").val();let fs_title=$("option:selected",$("#favorprogitem")).text();let fs_icon=fs_prog+".png";insertNewFavorMenuItem(fs_current_favor_item,fs_prog,fs_title,fs_icon)}});$("#favorprogitem").click(function(a){a.stopPropagation()});$("#favorcancelitem").click(function(a){a.stopPropagation();hideNewFavorItem()})});