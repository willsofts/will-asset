var defaultContentType="application/x-www-form-urlencoded; charset=UTF-8";function load_page(b,c,d){if(!$currPage||$currPage==""){$currPage=$("#page_0")}$currPage.hide();$currPage.removeClass("pt-page-current pt-page-moveFromRight pt-page-moveFromLeft");try{closeMenuBar()}catch(a){}loadApplication(b,c,d);$("#pagecontainer").show();$("#workingframe").hide();$("#languagemenuitem").hide()}function loadApplication(a,b,c){let fs_useruuid=$("#main_useruuid").val();let fs_user=$("#main_user").val();let appurl=BASE_URL+"/gui/"+a;console.log("load application url",appurl);let prm={useruuid:fs_useruuid,userid:fs_user,language:fs_default_language};if(b){let pr=b.split("&");for(let i=0;i<pr.length;i++){let kary=pr[i].split("=");prm[kary[0]]=kary[1]}}console.log("prm",prm);let authtoken=getAccessorToken();startWaiting();jQuery.ajax({url:appurl,data:prm,headers:{authtoken:authtoken},type:"POST",dataType:"html",contentType:defaultContentType,error:function(f,d,e){stopWaiting();let txt=$.trim(f.responseText);let $div=$("<div class='protection-error'></div>").html(txt);$("#pagecontainer").html($div)},success:function(e,d,f){stopWaiting();$("#pagecontainer").html(e);$currPage=$("#pagecontainer").children("div").eq(0);$currPage.addClass("pt-page-current pt-page-moveFromRight");$currPage.show();if(c){c()}}})}function open_page(c,a,e,d){console.log("open_page(appid="+c+",url="+a+",params="+e+",path="+d+")");let fs_newflag="1"==$("#accessor_label").data("NEW");if(!fs_newflag){if(!$currPage||$currPage==""){$currPage=$("#page_0")}$currPage.hide();$currPage.removeClass("pt-page-current pt-page-moveFromRight pt-page-moveFromLeft");try{closeMenuBar()}catch(b){}$("#languagemenuitem").hide()}open_program(c,a,e,d)}var except_apps=["page_profile","page_change","page_first","page_login","page_work","page_forgot"];function open_program(b,a,d,c){let fs_newwindows="1"==$("#accessor_label").data("NEW");console.log("open_program(appid="+b+", path="+c+", url="+a+", params="+d+")");let html=false;let appurl="/gui/"+b;if(c&&$.trim(c)!=""){appurl=c;html=c.indexOf(".html")>0}if(a&&$.trim(a)!=""){appurl="/load/"+b}console.log("open : "+appurl);$("#page_login").hide();let authtoken=getAccessorToken();if(fs_newwindows){let awin=openNewWindow({method:html?"GET":"POST",url:appurl,windowName:"fs_window_"+b,params:"seed="+Math.random()+"&authtoken="+authtoken+"&language="+fs_default_language+(d?"&"+d:"")});awin.focus()}else{$("#pagecontainer").hide();$("#workingframe").show();submitWindow({method:html?"GET":"POST",url:appurl,windowName:"workingframe",params:"seed="+Math.random()+"&authtoken="+authtoken+"&language="+fs_default_language+(d?"&"+d:"")});startWaiting()}recentApplication(b,a,d,c)}function recentApplication(b,a,d,c){let $rlist=$("#recentmenulist");let $items=$rlist.find("li");if($items.length>15){return}let found=false;$(except_apps).each(function(e,f){if(f==b){found=true;return false}});$items.each(function(e,f){if($(f).attr("appid")==b){found=true;return false}});if(found){return}let authtoken=getAccessorToken();jQuery.ajax({url:API_URL+"/api/apps/find",data:{programid:b},headers:{authtoken:authtoken},type:"POST",dataType:"html",contentType:defaultContentType,success:function(e){let json=$.parseJSON(e);if(json&&json.body.rows.length>0){let row=json.body.rows[0];let $li=$("<li></li>");let $alink=$("<a href='javascript:void(0)'></a>");$alink.addClass("dropdown-item").click(function(){open_page(b,a,d,c)}).html(row.description);$li.append($alink).attr("appid",b).attr("url",a).appendTo($rlist);$("#recentcaret").show()}}})}function startWaiting(){}function stopWaiting(){};