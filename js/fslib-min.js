var fs_default_raw_parameters=false;var fs_default_language="EN";var fs_mainPage="index";var fs_currentpid=null;var fs_langsDocs=null;var fs_mainDocs=null;var fs_defaultDocs=null;var fs_labelAry=null;var fs_winary=new Array();var fs_fontSize=14;var API_URL="";var BASE_URL="";var CDN_URL="";var API_TOKEN=null;var BASE_STORAGE="";var META_INFO={};function getWindowByName(c){if(!c){return null}for(let i=0,isz=fs_winary.length;i<isz;i++){try{if(fs_winary[i]){if(fs_winary[i].name==c){return fs_winary[i]}}}catch(b){}}return null}function closeChildWindows(){for(let i=0,isz=fs_winary.length;i<isz;i++){try{if(fs_winary[i]){fs_winary[i].close()}}catch(b){}}}function addWindow(b){if(!b){return}fs_winary.push(b)}function fs_getLanguageDocuments(c,b){console.log("progid="+c+", mainpage="+b);let aurl=API_URL+"/api/label/get";let docdata={};let authtoken=getAccessorToken();$.ajax({async:false,url:aurl,data:{labelname:c},headers:{authtoken:authtoken},type:"GET",dataType:"json",success:function(g,f,h){docdata=g}});if(!docdata){docdata={}}return docdata}function fs_getLangsDocs(c,b){console.log("getLangsDocs, langsDocs="+fs_langsDocs+", defaultDocs="+fs_defaultDocs+", mainDocs="+fs_mainDocs);if(!c||c==""){return fs_langsDocs}if(!fs_langsDocs){let json=fs_getLanguageDocuments(c,b);if(json&&json.body){fs_langsDocs=Object.assign({},json.body)}if(fs_mainPage==c&&json&&json.body){fs_mainDocs=Object.assign({},json.body)}}if(!fs_defaultDocs){let json=fs_getLanguageDocuments("default_label",b);if(json&&json.body){fs_defaultDocs=Object.assign({},json.body)}}if(fs_mainPage==c){if(!fs_mainDocs){let json=fs_getLanguageDocuments(c,b);if(json&&json.body){fs_mainDocs=Object.assign({},json.body)}}return fs_mainDocs}return fs_langsDocs}function fs_createHashElements(f,c,b){if(!f){return false}if(!c){return false}if(!b){return false}Object.assign(c,b[f]);return true}function fs_createLabelArrays(b){let result=[];if(!b){return result}let data=b.EN;if(!data){data=b.TH}if(data){result=Object.keys(data)}return result}var fs_hashLang={};function fs_switchingLanguage(g,f,c){if(!c||c==""){c=fs_currentpid}if(!fs_labelAry){fs_labelAry=fs_createLabelArrays(fs_getLangsDocs(c,f));if(fs_defaultDocs){let fs_defaultLabelAry=fs_createLabelArrays(fs_defaultDocs);if(fs_labelAry&&fs_defaultLabelAry){fs_labelAry=fs_labelAry.concat(fs_defaultLabelAry)}}}let fs_curArray=fs_labelAry;let fs_hash=fs_hashLang[g];if(!fs_hash){fs_hash={};if(fs_defaultDocs){fs_createHashElements(g,fs_hash,fs_defaultDocs)}fs_createHashElements(g,fs_hash,fs_getLangsDocs(c,f));fs_hashLang[g]=fs_hash}if(fs_mainPage==c){fs_hash={};if(fs_mainDocs){fs_curArray=fs_createLabelArrays(fs_mainDocs);fs_createHashElements(g,fs_hash,fs_mainDocs)}else{let json=fs_getLanguageDocuments(c,f);if(json&&json.body){fs_mainDocs=Object.assign({},json.body)}fs_curArray=fs_createLabelArrays(fs_mainDocs);fs_createHashElements(g,fs_hash,fs_mainDocs)}}if(fs_hash){for(let i=0;i<fs_curArray.length;i++){try{$("#"+fs_curArray[i]).html(fs_hash[""+fs_curArray[i]])}catch(b){}try{$("#"+fs_curArray[i]).val(fs_hash[""+fs_curArray[i]])}catch(b){}}}}function fs_switchLanguage(f,c){if(!f){return}f=f.toUpperCase();try{fs_switchingLanguage(f,c)}catch(b){}try{fs_changingLanguage(f,c)}catch(b){}fs_default_language=f}function fs_getLabelName(c,b,f){if(!b||b==""){b=fs_currentpid}let fs_Language=fs_default_language;if(f){fs_Language=f}let fs_hash=fs_hashLang[fs_Language];if(!fs_hash){fs_hash={};fs_createHashElements(fs_Language,fs_hash,fs_getLangsDocs(b));fs_hashLang[fs_Language]=fs_hash}if(fs_mainPage==b){if(fs_mainDocs){fs_hash={};fs_createHashElements(fs_Language,fs_hash,fs_mainDocs)}else{fs_hash={};fs_createHashElements(fs_Language,fs_hash,fs_getLangsDocs(b))}}if(fs_hash){return fs_hash[c]}return null}function fs_stopAnchorTaborder(){try{let links=document.getElementsByTagName("A");for(let i=0,j=links.length;i<j;i++){links[i].setAttribute("tabIndex","-1")}}catch(b){}}function fs_enterTab(c,b){let key;let keychar;if(window.event){key=window.event.keyCode}else{if(b){key=b.which}else{return true}}keychar=String.fromCharCode(key);if((key==null)||(key==0)||(key==8)||(key==9)||(key==27)){return true}else{if(key!=13){return true}}}function convert(b){if(b==null){return""}let i=0;let result="";for(i=0;i<b.length;i++){let a=b.charCodeAt(i);if(a>3424){a=a-3424;result=result+String.fromCharCode(a)}else{result=result+b.charAt(i)}}result=escape(result);while(result.indexOf("+")!=-1){result=result.replace("+","%2B")}return result}function openWindow(f,k,c,b,h){if(!k){return}try{let fswin=getWindowByName(k);if(fswin){fswin.focus();return}}catch(g){}if(!c){c=window.screen.availWidth}if(!b){b=window.screen.availHeight}if(!f){f=""}let sw=window.screen.availWidth;let sh=window.screen.availHeight;try{if(h==null){h=fs_fullscreen}}catch(g){}if(h){c=sw;b=sh}let wx=(sw-c)/2;let wy=(sh-b)/2;let features="top="+wy+",left="+wx+",width="+c+",height="+b+",toobar=no,menubar=1,location=no,directories=no,status=no,scrollbars=yes,resizable=yes";let fs_window=window.open(f,k,features);fs_window.opener=self;try{if("_self"!=k.toLowerCase()){addWindow(fs_window)}}catch(g){}return fs_window}function validNumeric(b){let data=b.value;if(data!=""){data=clearComma(data);if(data.length>1){if(data.indexOf(".")==0){data="0"+data}if(data.indexOf(".")==data.length-1){data+="0"}}data=formatFloat(data,b.getAttribute("DECIMAL"));if(data==0||Number(data)){}else{return false}b.value=putComma(data)}return true}function formatFloat(c,b){if(b==null||b<=0){return c}let dec="0";dec+=(c.indexOf(".")>-1)?c.substring(c.indexOf(".")):".0";let i=b-(dec.length-2);for(;i>0;i--){dec+="0"}let x=(c.indexOf(".")>-1)?c.substring(0,c.indexOf(".")):c;return x+dec.substring(dec.indexOf("."))}function validDate(b){if(b==null||b.value==""){return true}if(formatDate(b.value)){return true}else{return false}}function formatDate(mydate){let delimiter="/";let dmy=/\d{1,2}\/\d{1,2}\/\d{2,4}/;if(!mydate.match(dmy)){return false}let intDay=new Date();intDay.setDate(1);let ary_date=mydate.split(delimiter);let y=ary_date[2];if(y.length==2){if(y>=80){y=intDay.getYear()-100-(intDay.getYear()%100)+eval(y)}else{y=intDay.getYear()-(intDay.getYear()%100)+eval(y)}}else{if(y.length==3){return false}}intDay.setYear(y);let m=eval(ary_date[1]);if((m>0)&&(m<=12)){intDay.setMonth(m);intDay.setDate(0)}else{return false}let d=eval(ary_date[0]);if((d>0)&&(d<=intDay.getDate())){return true}else{return false}}function validRangeDate(a,b){try{if(a!=""&&b!=""){let vala=a.split("/").reverse().join("");let valb=b.split("/").reverse().join("");if(eval(valb)<eval(vala)){return false}}}catch(ex){}return true}function increaseValue(b,f,c){if(!c){c=0}return forValue(b,f,c,"+")}function decreaseValue(b,f,c){if(!c){c=0}return forValue(b,f,c,"-")}function forValue(avalue,addonvalue,decimal,flag){let result=eval(removeComma(avalue));if(decimal>0){let mval=Math.pow(10,decimal);let addon=addonvalue*mval;result=result*mval;if(flag=="+"){result=result+addon}else{result=result-addon}result=result/mval}else{if(flag=="+"){result=result+addonvalue}else{result=result-addonvalue}}return result}function parseNumber(avalue){return eval(removeComma(avalue))}function removeComma(b){let result=b;while(result.indexOf(",")>-1){result=removeDelimiter(result,",")}return result}function removeDelimiter(b,c){return b.replace(c,"")}function formatFloating(b,c){b=b+"";b=removeComma(b);return formatDecimal(b,c,true)}function formatDecimal(c,f,b){let sign="";let result=c+"";let bstr="";let cstr="";let i=result.indexOf("-");if(i>=0){sign="-";result=result.substring(i+1)}else{i=result.indexOf("+");if(i>=0){sign="+";result=result.substring(i+1)}}let astr=result;i=result.indexOf(".");if(i>0){astr=result.substring(0,i);bstr=result.substring(i+1);cstr=result.substring(i)}let la=astr.length;if(la>3){let tstr=astr;astr="";while(tstr!=""){la=tstr.length;let md=la%3;if(md>0){astr+=tstr.substring(0,md)+",";tstr=tstr.substring(md)}else{astr+=tstr.substring(0,3);tstr=tstr.substring(3);if(tstr!=""){astr+=","}}}}if(b){if(f>0){let l=bstr.length;if(f>l){let j=0;for(j=l;j<f;j++){bstr+="0"}}else{bstr=bstr.substring(0,f)}if(astr==""){return""}return sign+astr+"."+bstr}else{return sign+astr}}else{return sign+astr+cstr}}function getTimeNow(){let now=new Date();let hh=now.getHours();let mm=now.getMinutes();let ss=now.getSeconds();let result=((hh<10)?"0":"")+hh;result+=((mm<10)?":0":":")+mm;result+=((ss<10)?":0":":")+ss;return result}function getDateNow(){let now=new Date();let dd=now.getDate();let mm=now.getMonth()+1;let yy=now.getFullYear();let result=((dd<10)?"0":"")+dd;result+=((mm<10)?"/0":"/")+mm;result+="/"+yy;return result}let regPicture=/[9XEATxea]/;function fs_intNumsOnly(g,f,c,b){let key;let keychar;if(f){key=f.which}else{return true}keychar=String.fromCharCode(key);let element=g;b=(b!=null)?true:false;let isPoint=(c!=null&&c!=0)?true:false;if(key==45&&element.value.indexOf("-")==-1&&!b){element.value="-"+element.value}if((key==46)&&(element.value.indexOf(".")==-1)&&isPoint){if(element.value==""){element.value="0"}return true}if((key==null)||(key==0)||(key==8)||(key==9)||(key==27)){return true}else{if((("0123456789").indexOf(keychar)>-1)){return true}else{return false}}}function fs_intNumsOnly_chkKey(g,f,c,b){let iskeyup=g.getAttribute("keyup");if(iskeyup==null){}else{if(iskeyup==false){event.returnValue=false;return false}}g.setAttribute("keyup",false);return fs_intNumsOnly(g,f,c,b)}function fs_chkKey(g,f,b,c){let iNum=f.keyCode;if(((iNum>=48)&&(iNum<=57))||((iNum>=96)&&(iNum<=105))||iNum==109||iNum==110||iNum==189||iNum==190){g.setAttribute("keyup",true);let c_pos=getCaretPosition(g);let o_len=g.value.length;formatNumber(g,c,b);let n_len=g.value.length;setCaretPosition(g,n_len>o_len?c_pos+1:c_pos)}}function formatNumber(element,maxvalue,decimal){let valueBfChange=element.value;let data=element.value;let point=0;if(decimal!=null&&decimal!=""){point=(eval(decimal)>=0)?eval(decimal):99}let fraction=null;if(maxvalue!=null&&maxvalue!=""){if(eval(maxvalue)>=0){fraction=maxvalue;if(data.indexOf("-")>-1){fraction++}}else{fraction=null}}data=clearComma(data);try{let dot="";let x=data.split(".");if(x.length==2&&point>0){dot=(x[1].length>point)?("."+x[1].substring(0,point)):("."+x[1])}while(x[0].length>1&&x[0].charAt(0)=="0"){x[0]=x[0].substring(1)}if((fraction==0&&eval(x[0])>0)||(fraction>0&&x[0].length>fraction)){element.value=valueBfChange;return true}data=x[0]+dot}catch(ex){}element.value=putComma(data)}function putComma(b){if(b.indexOf(",")>-1){b=clearComma(b)}let move=(b.indexOf(".")>-1)?b.indexOf("."):b.length;let minus=(b.indexOf("-")>-1)?1:0;while(move>3){if(minus&&move<=4){break}b=b.substring(0,move-3)+","+b.substring(move-3);move-=3}return b}function clearComma(b){while(b.indexOf(",")!=-1){b=b.replace(",","")}return b}function getCaretPosition(b){let iCaretPos=0;if(document.selection){b.focus();let selector=document.selection.createRange();selector.moveStart("character",-b.value.length);iCaretPos=selector.text.length}else{if(b.selectionStart||b.selectionStart=="0"){iCaretPos=b.selectionStart}}return(iCaretPos)}function setCaretPosition(b,c){if(b.createTextRange){let selector=b.createTextRange();selector.collapse(true);selector.moveEnd("character",c);selector.moveStart("character",c);selector.select()}else{if(b.selectionStart||b.selectionStart=="0"){b.selectionStart=c;b.selectionEnd=c;b.focus()}}}function enableElements(b){$("input[type!=hidden]:disabled, select:disabled, button:disabled, textarea:disabled, a",b||this.document).each(function(c,f){let e=$(this);if(e.data("fs_disabled_element")){e.attr("disabled",false);if(e.is("a")){e.attr("disables",false);let ahref=e.data("fs_ahref");if(ahref){e.attr("href",ahref)}let fnclick=e.data("fs_fnclick");if(fnclick){e.bind("click",fnclick)}}}})}function disableElements(b){$("input[type!=hidden]:enabled, select:enabled, button:enabled, textarea:enabled, a",b||this.document).each(function(c,f){let e=$(this);if(!e.is(".ignoredisabled")){e.attr("disabled",true);e.data("fs_disabled_element",true);if(e.is("a")){if(!e.is(".allowdisabled")){e.attr("disabled",false)}e.attr("disables",true);let ahref=e.attr("href");if(ahref){e.removeAttr("href");e.data("fs_ahref",ahref)}let fnclick=e.data("fs_fnclick");if(fnclick){e.unbind("click",fnclick)}fnclick=e.attr("onclick");if(fnclick){e.removeAttr("onclick");e.data("fs_fnclick",fnclick)}}}})}function enableButtons(){$("input[type=submit]:disabled, input[type=reset]:disabled, input[type=button]:disabled, button:disabled").each(function(b,c){$(this).attr("disabled",false)})}function disableButtons(){$("input[type=submit]:enabled, input[type=reset]:enabled, input[type=button]:enabled, button:enabled").each(function(b,c){$(this).attr("disabled",true)})}function enableForm(b){$("input[type=submit]:disabled, input[type=reset]:disabled, input[type=button]:disabled, button:disabled",b).each(function(c,f){$(this).attr("disabled",false)})}function disableForm(b){$("input[type=submit]:enabled, input[type=reset]:enabled, input[type=button]:enabled, button:enabled",b).each(function(c,f){$(this).attr("disabled",true)})}function handleFocus(){$("input[type=text]:enabled, textarea:enabled").each(function(b,c){$(this).focusin(function(){$(this).addClass("ui-active-input")});$(this).focusout(function(){$(this).removeClass("ui-active-input")})})}function hideLayer(b){$(b).hide()}function showLayer(b){$(b).show()}function startWaiting(){try{let dc=$(document.body);let sh=dc.innerHeight();let fslayer=$("#fswaitlayer");let lh=fslayer.height();let fstop=mouseY;if(lh>(sh-fstop)){fstop=mouseY-lh}fslayer.css("top",fstop);fslayer.css("left",mouseX>0?mouseX:dc.innerWidth()-50);fslayer.show()}catch(b){}}function stopWaiting(){try{hideLayer("#fswaitlayer")}catch(b){}}function handleDataTable(b){if(!b){b=$("#listpanel")}$(".drowclass",b).each(function(c,f){let e=$(this);e.dblclick(function(){let alink=$("a.anclass:eq(0)",e);if(alink){alink.trigger("click")}else{$("input.buttonedit:eq(0)",e).trigger("click")}});e.mouseenter(function(){$("td",e).each(function(g,h){$(this).addClass("ui-state-highlight")})});e.mouseleave(function(){$("td",e).each(function(g,h){$(this).removeClass("ui-state-highlight")})})})}function handleDecimalElements(b){$(".idecimal",b||this.document).each(function(c,f){let df=$(this);let decimals=df.attr("decimal");df.blur(function(){let v=df.val();if(v==""){v="0"}df.val(formatFloat(v,decimals))})})}function clearingFields(b){$("input[type=text]",b||this.document).each(function(c,f){let input=$(this);input.val("");if(input.is(".ilookup")){$("#"+input.attr("id")+"desc").html("")}});$("textarea",b||this.document).each(function(c,f){$(this).val("")})}function initialFocus(b){$("input:visible:eq(0)",b).trigger("focusin").focus()}function startApplication(b,g,f){fs_currentpid=b;fs_langsDocs=null;fs_labelAry=null;fs_hashLang={};if(!g){bindHangOut()}initialAjax();initialApplicationControls(f);try{$.fn.modal.prototype.constructor.Constructor.DEFAULTS.backdrop="static";$.fn.modal.prototype.constructor.Constructor.DEFAULTS.keyboard=false}catch(c){}try{$.fn.modal.Constructor.Default.backdrop="static";$.fn.modal.Constructor.Default.keyboard=false}catch(c){}initialComponents();try{requestAccessorInfo()}catch(c){}}function initialAjax(){$.ajaxPrefilter(function(b,f,c){let token=getAccessorToken();if(token){b.headers=$.extend({authtoken:token},b.headers)}})}function initialApplicationControls(b){$("input[type=text]",b||this.document).each(function(c,g){let input=$(this);try{if(input.attr("picture")){input.mask(input.attr("picture"))}}catch(f){}});$("input[type=text].itime",b||this.document).each(function(c,f){$(this).clockpicker({align:"left",autoclose:true,donetext:"Done",cleartext:"Clear"})});$("select[readonly] option:not(:selected)",b||this.document).attr("disabled",true);$("input[type=radio][readonly]",b||this.document).bind("click",function(){return false});$("input[type=checkbox][readonly]",b||this.document).bind("click",function(){return false});$("input[type=radio]",b||this.document).each(function(){if($(this).attr("readonly")){$(this).parent().wrap($("<fieldset disabled></fieldset>"))}});$("input[type=checkbox]",b||this.document).each(function(){if($(this).attr("readonly")){$(this).parent().wrap($("<fieldset disabled></fieldset>"))}});setupScreenControls(b)}function initialComponents(){$("#viewversionlinker").click(function(){console.log("view version: "+$(this).attr("data-pid"));try{viewVersion($("#viewversionlinker").attr("data-pid"))}catch(b){}});$("#increasefontlinker").click(function(){increaseFontSize()});$("#decreasefontlinker").click(function(){decreaseFontSize()})}function viewVersion(b){}function bindHangOut(){$(document).bind("click",function(c){try{window.parent.hangOut()}catch(b){}})}function setupApplication(c){fs_stopAnchorTaborder();try{if(fs_default_language.toUpperCase()!="EN"){fs_switchLanguage(fs_default_language,true)}}catch(b){}try{backHawkDown()}catch(b){}try{$(window).bind("unload",closeChildWindows)}catch(b){}}function setupScreenControls(b){$("input[type=text].idate",b||this.document).each(function(c,f){let $this=$(this);let id=$this.attr("id");$("#LK"+id).click(function(){fs_opencalendar(document.getElementById(id))});$("#CLR"+id).click(function(){fs_clearcalendar(document.getElementById(id))})});$("input[type=text].iint",b||this.document).each(function(c,f){$(this).on("keypress",function(g){return fs_intNumsOnly(this,g)})});$("input[type=text].imoney",b||this.document).each(function(c,f){let $this=$(this);let decimal=$this.attr("decimal");$this.on("keyup",function(g){return fs_chkKey(this,g,decimal,null)});$this.on("keypress",function(g){return fs_intNumsOnly_chkKey(this,g,decimal)})})}function setupPageSorting(c,b){if(!c){c="datatable"}if(!b){b=submitOrder}$("#"+c).find(".fa-data-sort").each(function(f,g){$(g).click(function(){if($(this).is(":disabled")){return}let sorter=$(this).attr("data-sorter");b(g,sorter)})})}function setupPagination(g,b,f,c){if(!g){g="fschapterlayer"}if(!f){f=fschapterform}if(!b){b=submitChapter}$("#"+g).find(".fa-data-page").each(function(h,k){$(k).click(function(){if($(this).is(":disabled")){return}let pageno=$(this).attr("data-paging");if(c){try{c.page.value=pageno}catch(n){}}f.page.value=pageno;b(f,pageno)})})}function startPeriodical(b){}function prepareOptions(h,f,o,c,b,n,k){if(!h){return}if(!b){try{b=h.undefinedlookup["value"]}catch(g){}}try{if(!b){b="   "}if(c!=null){$("<option value='"+c+"'>"+b+"</option>").appendTo(o)}let opts=h[f];if(opts){for(let p in opts){if(n){if(k){if(p!=""){$("<option value='"+p+"'>"+(p+" - "+opts[p])+"</option>").appendTo(o)}}else{$("<option value='"+p+"'>"+(p+" - "+opts[p])+"</option>").appendTo(o)}}else{if(k){if(p!=""){$("<option value='"+p+"'>"+opts[p]+"</option>").appendTo(o)}}else{$("<option value='"+p+"'>"+opts[p]+"</option>").appendTo(o)}}}}}catch(g){}}function backHawkDown(){$(document).on("keydown",function(b){if(b.which==8&&!$(b.target).is("input:not([readonly]), textarea")){b.preventDefault();return}if(b.which==17){b.preventDefault();return}})}function notAllowRightClick(){$(document).on("contextmenu",function(b){b.preventDefault();return false})}function submitWindow(b){let p=b;if((p.url&&p.url!="")&&p.params){let frm=$("<form method='POST'></form>");frm.attr("action",p.url);frm.attr("target",p.windowName);if(typeof(p.params)==="string"){let prms=p.params.split("&");for(let i=0;i<prms.length;i++){let kary=prms[i].split("=");let inp=$('<input type="hidden" name="'+kary[0]+'"></input>');inp.val(kary[1]);frm.append(inp)}}else{if($.isArray(p.params)){for(let i=0;i<p.params.length;i++){let prm=p.params[i];if(prm.name){let inp=$('<input type="hidden" name="'+prm.name+'"></input>');inp.val(prm.value);frm.append(inp)}}}else{if(p.params){for(let prm in p.params){let inp=$('<input type="hidden" name="'+prm+'"></input>');inp.val(p.params[prm]);frm.append(inp)}}}}let layer=$("<div class='open-new-window-submit-layer'></div>");layer.append(frm);$("body").append(layer);frm.trigger("submit");setTimeout(function(){layer.remove()},1500)}}function openNewWindow(c){let defaultSettings={url:"",windowName:"_blank",windowWidth:window.screen.availWidth,windowHeight:window.screen.availHeight,windowFeatures:"toobar=no,menubar=no,location=no,directories=no,status=no,scrollbars=yes,resizable=yes",fullScreen:null,params:null};let p=$.extend({},defaultSettings,c);try{let fswin=window.parent.getWindowByName(p.winName);if(fswin){fswin.focus();return}}catch(b){}let sw=window.screen.availWidth;let sh=window.screen.availHeight;try{if(p.fullScreen==null){p.fullScreen=fs_fullscreen}}catch(b){}if(p.fullScreen){winWidth=sw;winHeight=sh}let wx=(sw-p.windowWidth)/2;let wy=(sh-p.windowHeight)/2;let fs_features="top="+wy+",left="+wx+",width="+p.windowWidth+",height="+p.windowHeight+","+p.windowFeatures;let fs_window=null;if(p.params){fs_window=window.open("",p.windowName,fs_features)}else{fs_window=window.open(p.url,p.windowName,fs_features)}fs_window.opener=self;try{window.parent.addWindow(fs_window)}catch(b){}submitWindow(p);return fs_window}function parseErrorThrown(g,b,f){if(!f){f=g.responseText}else{if(f==g.status){f=g.responseText}}try{if(g.status==400||g.status==401){f=g.responseText}let json=$.parseJSON(g.responseText);if(json.text){f=json.text}if(json.head.errordesc){f=json.head.errordesc}}catch(c){}if($.trim(f)==""){f="Unknown error or network error"}return f}function replaceString(b,c){if(c){let regex=/%s/;for(let i=0;i<c.length;i++){let t_str=c[i];b=b.replace(regex,t_str)}}if(b){let regex=/%s/g;b=b.replace(regex,"")}return b}var msgxmldoc=null;function loadXMLMessage(b){jQuery.ajax({url:"/xml/smart_message.xml?seed="+Math.random(),async:b,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"xml",error:function(g,c,f){},success:function(f,c,g){msgxmldoc=f}})}function getMessageCode(c,f){try{if(msgxmldoc==null){loadXMLMessage(false)}let msgnode=$("root msg[code="+c+"]",msgxmldoc);let fs_curlang=fs_default_language;if(!fs_curlang){fs_curlang="EN"}let fs_msgtext=msgnode.find(fs_curlang.toUpperCase()).text();if(!fs_msgtext){return c}if(fs_msgtext&&fs_msgtext!=""){return replaceString(fs_msgtext,f)}return msgnode.text()}catch(b){}return c}function getMessageTitle(c,b){let fs_msgtitle=getMessageCode(c);if(!fs_msgtitle||fs_msgtitle==""){fs_msgtitle=b}return fs_msgtitle}function createDialog(b){}function confirmDialogBox(k,o,c,h,g,f,b,n){let txt=getMessageCode(k,o);if(txt!=null&&txt!=""){if(n){txt+=" "+n}confirmDialog(txt,h,g,f,b);return false}else{if(c){return confirmDialog(c,h,g,f,b)}else{return confirmDialog(k,h,g,f,b)}}}function confirmDelete(h,g,f,c,b){if(!confirmDialogBox("QS0001",h,"Do you want to delete this transaction?",g,f,c,b)){return false}return true}function confirmSave(g,f,c,b){if(!confirmDialogBox("QS0002",null,"Do you want to save this transaction?",g,f,c,b)){return false}return true}function confirmCancel(g,f,c,b){if(!confirmDialogBox("QS0003",null,"Do you want to cancel this transaction?",g,f,c,b)){return false}return true}function confirmRemove(h,g,f,c,b){if(!confirmDialogBox("QS0005",h,"Do you want to delete this record?",g,f,c,b)){return false}return true}function confirmSend(g,f,c,b){if(!confirmDialogBox("QS0006",null,"Do you want to send this transaction?",g,f,c,b)){return false}return true}function confirmUpdate(g,f,c,b){if(!confirmDialogBox("QS0014",null,"Do you want to update this transaction?",g,f,c,b)){return false}return true}function confirmClear(h,g,f,c,b){if(!confirmDialogBox("QS0015",h,"Do you want to clear this?",g,f,c,b)){return false}return true}function confirmProcess(g,f,c,b){if(!confirmDialogBox("QS0018",null,"Do you want to process this transaction?",g,f,c,b)){return false}return true}function confirmReceive(g,f,c,b){if(!confirmDialogBox("QS0020",null,"Do you want to receive this transaction?",g,f,c,b)){return false}return true}function confirmReset(g,f,c,b){if(!confirmDialogBox("QS0021",null,"Do you want to reset this trasaction?",g,f,c,b)){return false}return true}function confirmErase(h,g,f,c,b){if(!confirmDialogBox("QS0022",h,"Do you want to delete %s row(s)?",g,f,c,b)){return false}return true}function confirmApprove(h,g,f,c,b){if(!confirmDialogBox("QS0024",h,"Do you want to confirm approve the %s request?",g,f,c,b)){return false}return true}function confirmReject(h,g,f,c,b){if(!confirmDialogBox("QS0025",h,"Do you want to reject %s?",g,f,c,b)){return false}return true}function confirmRequest(g,f,c,b){if(!confirmDialogBox("QS0027",null,"Do you want to create this request?",g,f,c,b)){return false}return true}function confirmImport(g,f,c,b){if(!confirmDialogBox("QS0028",null,"Do you want to import this transaction?",g,f,c,b)){return false}return true}function confirmExport(g,f,c,b){if(!confirmDialogBox("QS0029",null,"Do you want to export this transaction?",g,f,c,b)){return false}return true}function confirmResend(g,f,c,b){if(!confirmDialogBox("QS0032",null,"Do you want to resend this transaction?",g,f,c,b)){return false}return true}function confirmRevise(h,g,f,c,b){if(!confirmDialogBox("QS0033",h,"Do you want to revise the %s request?",g,f,c,b)){return false}return true}function successbox(c,b){alertbox("QS0004",c,null,b)}function alertbox(c,g,b,f){let txt=getMessageCode(c,f);if(txt!=null&&txt!=""){alertDialog(txt,g)}else{if(b){alertDialog(b,g)}else{alertDialog(c,g)}}}function confirmbox(g,f,c,b,h){let txt=getMessageCode(g,h);if(txt!=null&&txt!=""){return confirmDialog(txt,f,c)}else{if(b){return confirmDialog(b,f,c)}else{return confirmDialog(g,f,c)}}}function alertDialog(h,c,g,b){try{let fs_okbtn=getMessageCode("fsokbtn");if(!fs_okbtn||(fs_okbtn==""||fs_okbtn=="fsokbtn")){fs_okbtn="OK"}bootbox.alert({message:h,callback:function(){if(c){c()}},buttons:{ok:{label:fs_okbtn}}});$(".bootbox > .modal-dialog").draggable();return}catch(f){console.log(f.description)}if(c){c()}}function confirmDialog(k,h,c,g,b){try{let fs_confirmbtn=getMessageCode("fsconfirmbtn");if(!fs_confirmbtn||(fs_confirmbtn==""||fs_confirmbtn=="fsconfirmbtn")){fs_confirmbtn="OK"}let fs_cancelbtn=getMessageCode("fscancelbtn");if(!fs_cancelbtn||(fs_cancelbtn==""||fs_cancelbtn=="fscancelbtn")){fs_cancelbtn="Cancel"}bootbox.confirm({message:k,callback:function(n){if(n){if(h){h()}}else{if(c){c()}}},buttons:{confirm:{label:fs_confirmbtn},cancel:{label:fs_cancelbtn}}});$(".bootbox > .modal-dialog").draggable();return}catch(f){console.log(f.description)}}function submitFailure(f,b,c){stopWaiting();console.log(f.responseText);console.log("status = "+b+" : xhr = "+f.status);c=parseErrorThrown(f,b,c);alertbox(c,function(){if(f.status==401){try{window.parent.reLogin()}catch(g){}}})}function alertmsg(b,f,c,g){alertbox(b,g,f,c)}function confirmmsg(f,h,g,c,b){confirmbox(f,c,b,h,g)}function bootAlertDialog(g,h,f,b){try{let fs_okbtn=getMessageCode("fsokbtn");if(!fs_okbtn||(fs_okbtn==""||fs_okbtn=="fsokbtn")){fs_okbtn="OK"}bootbox.alert({message:g,callback:function(){if(h){h()}},buttons:{ok:{label:fs_okbtn,className:"btn-primary btn-base"}}});$(".bootbox > .modal-dialog").draggable();return}catch(c){console.log(c.description)}if(h){h()}}function bootConfirmDialog(k,h,c,g,b){try{let fs_confirmbtn=getMessageCode("fsconfirmbtn");if(!fs_confirmbtn||(fs_confirmbtn==""||fs_confirmbtn=="fsconfirmbtn")){fs_confirmbtn="OK"}let fs_cancelbtn=getMessageCode("fscancelbtn");if(!fs_cancelbtn||(fs_cancelbtn==""||fs_cancelbtn=="fscancelbtn")){fs_cancelbtn="Cancel"}bootbox.confirm({message:k,callback:function(n){if(n){if(h){h()}}else{if(c){c()}}},buttons:{confirm:{label:fs_confirmbtn,className:"btn-primary btn-base"},cancel:{label:fs_cancelbtn,className:"btn-primary btn-base"}}});$(".bootbox > .modal-dialog").draggable();return}catch(f){console.log(f.description)}}function alertboot(c,g,b,f){let txt=getMessageCode(c,f);if(txt!=null&&txt!=""){bootAlertDialog(txt,g)}else{if(b){bootAlertDialog(b,g)}else{bootAlertDialog(c,g)}}}function confirmboot(g,f,c,b,h){let txt=getMessageCode(g,h);if(txt!=null&&txt!=""){return bootConfirmDialog(txt,f,c)}else{if(b){return bootConfirmDialog(b,f,c)}else{return bootConfirmDialog(g,f,c)}}}function fs_beforedeactivate(c,b){}function fs_deactivate(c,b){}function fs_rival_deactivate(c,b){}function fs_rival_beforedeactivate(c,b){}function toggleCollapseExpand(b){let $src=$(b);if($src.is(".down")){$src.removeClass("down").addClass("up");$src.find(".fa").removeClass("fa-chevron-circle-down").addClass("fa-chevron-circle-up");let $part=$src.parents("table").eq(0);$part.nextUntil("table.partition-table").show()}else{$src.removeClass("up").addClass("down");$src.find(".fa").removeClass("fa-chevron-circle-up").addClass("fa-chevron-circle-down");let $part=$src.parents("table").eq(0);$part.nextUntil("table.partition-table").hide()}}function handleControls(b,f,c){if(b){for(let p in b){$("input[name="+p+"]").change(function(){let that=$(this);let fs_ctrls=b[that.attr("name")];if(fs_ctrls){$(fs_ctrls).each(function(g,h){if(h.value==that.val()){if(h.hidden){$("#"+h.control).show()}else{$("#"+h.control).attr("disabled",false);$("input",$("#"+h.control)).attr("disabled",false);$("select",$("#"+h.control)).attr("disabled",false);$("input:checked",$("#"+h.control)).trigger("change");$("select:selected",$("#"+h.control)).trigger("change")}}else{if(h.hidden){$("#"+h.control).hide()}else{$("#"+h.control).attr("disabled",true);$("input",$("#"+h.control)).attr("disabled",true);$("select",$("#"+h.control)).attr("disabled",true);$("input:checked",$("#"+h.control)).trigger("change");$("select:selected",$("#"+h.control)).trigger("change");if(!$("#"+h.control).is(":checkbox")&&!$("#"+h.control).is(":radio")){$("#"+h.control).val("")}}}})}})}}if(f){for(let p in f){$("#"+p).change(function(){let that=$(this);let fs_ctrls=f[that.attr("id")];if(fs_ctrls){let fs_ischecked=that.is(":checked");$(fs_ctrls).each(function(g,h){if(fs_ischecked){if(h.hidden){$("#"+h.control).show()}else{$("#"+h.control).attr("disabled",false);$("input",$("#"+h.control)).attr("disabled",false);$("select",$("#"+h.control)).attr("disabled",false);$("input:checked",$("#"+h.control)).trigger("change");$("select:selected",$("#"+h.control)).trigger("change")}}else{if(h.hidden){$("#"+h.control).hide()}else{$("#"+h.control).attr("disabled",true);$("input",$("#"+h.control)).attr("disabled",true);$("select",$("#"+h.control)).attr("disabled",true);$("input:checked",$("#"+h.control)).trigger("change");$("select:selected",$("#"+h.control)).trigger("change");if(!$("#"+h.control).is(":checkbox")&&!$("#"+h.control).is(":radio")){$("#"+h.control).val("")}}}})}})}}if(c){for(let p in c){$("select[name="+p+"]").change(function(){let that=$(this);let fs_ctrls=c[that.attr("name")];if(fs_ctrls){$(fs_ctrls).each(function(g,h){if(h.value==that.val()){if(h.hidden){$("#"+h.control).show()}else{$("#"+h.control).attr("disabled",false);$("input",$("#"+h.control)).attr("disabled",false);$("select",$("#"+h.control)).attr("disabled",false);$("input:checked",$("#"+h.control)).trigger("change");$("select:selected",$("#"+h.control)).trigger("change")}}else{if(h.hidden){$("#"+h.control).hide()}else{$("#"+h.control).attr("disabled",true);$("input",$("#"+h.control)).attr("disabled",true);$("select",$("#"+h.control)).attr("disabled",true);$("input:checked",$("#"+h.control)).trigger("change");$("select:selected",$("#"+h.control)).trigger("change");if(!$("#"+h.control).is(":checkbox")&&!$("#"+h.control).is(":radio")){$("#"+h.control).val("")}}}})}})}}}function initialControls(b,f,c){if(b){for(let p in b){$("input[name="+p+"]").each(function(g,h){let that=$(h);if(that.is(":checked")){that.trigger("change")}})}}if(f){for(let p in f){let that=$("#"+p);that.trigger("change")}}if(c){for(let p in c){$("select[name="+p+"]").each(function(g,h){let that=$(h);that.trigger("change")})}}}function startEntryPage(){}function hasInset(f,c,b){if(!b){b=","}let sets=f.split(b);for(let p in sets){if(c.toLowerCase()==sets[p].toLowerCase()){return true}}return false}function toYMDDate(b){let txts=b.split("/");return(txts.length>2?txts[2]:"")+"/"+(txts.length>1?txts[1]:"")+"/"+(txts.length>0?txts[0]:"")}function validNumericFields(b){let valid=true;$("input.iint, input.imoney",b).each(function(c,f){let ths=$(this);let text=removeComma(ths.val());if(isNaN(text)){valid=false;alertbox("Invalid Numeric Field: Not a Number",function(){setTimeout(function(){ths.focus()},500)});return false}let precision=ths.attr("precision");let decimal=ths.attr("decimal");if(precision){let txts=text;let precise=parseNumber(precision+"");let idx=txts.indexOf(".");if(idx>=0){txts=txts.substring(0,idx)}if(precise<txts.length){valid=false;alertbox("Invalid Numeric Field: Precision ("+precision+") or decimal"+(decimal?" ("+decimal+")":"")+" is over",function(){setTimeout(function(){ths.focus()},500)});return false}}if(decimal){let txts=text;let scale=parseNumber(decimal+"");let idx=txts.indexOf(".");if(idx>=0){txts=txts.substring(idx+1);if(scale<txts.length){valid=false;alertbox("Invalid Numeric Field: Precision"+(precision?" ("+precision+")":"")+" or decimal ("+decimal+") is over",function(){setTimeout(function(){ths.focus()},500)});return false}}}});return valid}function assignControlValue(c,b){let controlbox=false;let input=$("input[name="+c+"]");if(input.length>0){$(input).each(function(f,g){let $e=$(g);if($e.is(":checkbox")||$e.is(":radio")){if($e.val()==b){$e.attr("checked",true)}controlbox=true}})}if(!controlbox){let ctrl=$("#"+c);ctrl.val(b);if(ctrl.is("select")&&ctrl.is("[readonly]")){$("option:selected",ctrl).attr("disabled",false);$("option:not(:selected)",ctrl).attr("disabled",true)}else{if(ctrl.is("label")){ctrl.html(b)}}}}function validCompletedFields(b){for(let p in b){let spec=b[p];let input=$("input[name="+p+"]");let valid=false;if(input.length>1){$(input).each(function(c,f){let $e=$(f);if($e.is(":checked")){valid=true;return false}});input=input.eq(0)}else{input=$("#"+p);if(input.is(":checkbox")){valid=input.is(":checked")}else{valid=$.trim(input.val())!=""}}if(!valid){alertbox("Field Uncompleted: "+spec.msg,function(){setTimeout(function(){input.focus()},500)});return false}}return true}function controlFontSize(b){$("input:not(:button)").css("font-size",b);$("select").css("font-size",b)}function increaseFontSize(){fs_fontSize++;controlFontSize(fs_fontSize);$.cookie("fsfontsize",fs_fontSize)}function decreaseFontSize(){fs_fontSize--;controlFontSize(fs_fontSize);$.cookie("fsfontsize",fs_fontSize)}function setupAlertComponents(b){$(".alert-input",b||this.document).focus(function(){let ths=$(this);ths.removeClass("is-invalid");let thisId=ths.attr("id");$("#"+thisId).parent().removeClass("has-error");$("#"+thisId+"_cover").removeClass("has-error");$("#"+thisId+"_alert").hide()}).blur(function(){let ths=$(this);ths.removeClass("is-invalid");let thisId=ths.attr("id");if($.trim(ths.val())==""){$("#"+thisId+"_alert").show()}$("#"+thisId+"_error").hide();let ctrl=ths.attr("control");if(ctrl){$(ctrl).hide()}})}function clearAlerts(b){$(".alert-input",b||this.document).each(function(c,f){let ths=$(this);let thisId=ths.attr("id");ths.removeClass("is-invalid");$("#"+thisId).parent().removeClass("has-error");$("#"+thisId+"_cover").removeClass("has-error");$("#"+thisId+"_alert").hide();let ctrl=ths.attr("control");if(ctrl){$(ctrl).hide()}})}function validRequiredFields(f,b,c){clearAlerts();let validationflag=false;let validator=null;for(let p in b){let valid=false;let input=$("#"+p);if(input.is(":checkbox")){valid=input.is(":checked")}else{valid=$.trim(input.val())!=""}if(!valid){input.addClass("is-invalid");input.parent().addClass("has-error");$("#"+p+"_alert").show();if(!validator){validator=p}}else{validationflag=true}}if(c&&validationflag){clearAlerts();if(f){f()}return true}else{if(validator){$("#"+validator).focus();setTimeout(function(){$("#"+validator).addClass("is-invalid");$("#"+validator).parent().addClass("has-error");$("#"+validator+"_alert").show()},100);return false}if(f){f()}return true}}function disableControls(){$(arguments).each(function(b,c){let $src=$(c);$src.attr("disabled",true);setTimeout(function(){$src.removeAttr("disabled")},1000)})}const fsmadatoryfields=["ajax","datatype","rowsPerPage","limit","page","orderBy","orderDir","offset","action"];function isMadatoryField(b){let found=false;$(fsmadatoryfields).each(function(c,f){if(f==b){found=true;return false}});return found}function createParameters(b){let result=[];if(!b){return result}let ary=$(b).serializeArray();$(ary).each(function(c,f){if(!isMadatoryField(f.name)){result.push(f)}});return result}function fetchParameters(b){if(!b){return""}let result=$.param(b);return result&&result!=""?"&"+result:""}function createMandatoryParameters(b){let result=[];if(!b){return result}let ary=$(b).serializeArray();$(ary).each(function(c,f){if(isMadatoryField(f.name)){result.push(f)}});return result}function getStorage(b){if("local"==BASE_STORAGE){return localStorage.getItem(b)}return sessionStorage.getItem(b)}function setStorage(b,c){if("local"==BASE_STORAGE){localStorage.setItem(b,c);return}sessionStorage.setItem(b,c)}function removeStorage(b){if("local"==BASE_STORAGE){localStorage.removeItem(b);return}sessionStorage.removeItem(b)}function getAccessorInfo(){let info=getStorage("accessorinfo");if(info&&info!=""){return $.parseJSON(info)}return null}function getAccessorToken(){let json=getAccessorInfo();if(json&&json.authtoken){return json.authtoken}if(API_TOKEN&&API_TOKEN!=""){return API_TOKEN}return""}function saveAccessorInfo(b){setStorage("accessorinfo",JSON.stringify(b))}function removeAccessorInfo(){removeStorage("accessorinfo")}function setupDiffie(b){console.log("setupDiffie",this.getAccessorToken());let info=b.body.info;if(info){const c=new DH();c.prime=info.prime;c.generator=info.generator;c.otherPublicKey=info.publickey;c.compute();c.updatePublicKey();info.privatekey=c.privateKey;info.publickey=c.publicKey;info.sharedkey=c.sharedKey;info.otherpublickey=c.otherPublicKey;saveAccessorInfo(b.body)}}function getDH(){let json=getAccessorInfo();if(json&&json.info){let info=json.info;if(info.prime&&info.generator&&info.publickey&&info.privatekey&&info.sharedkey&&info.otherpublickey){const b=new DH();b.prime=info.prime;b.generator=info.generator;b.otherPublicKey=info.publickey;b.privateKey=info.privatekey;b.publicKey=info.publickey;b.sharedKey=info.sharedkey;b.otherPublicKey=info.otherpublickey;return b}}return null}function sendMessageInterface(){let info=getAccessorInfo();let msg={type:"storage",API_URL:API_URL,BASE_URL:BASE_URL,API_TOKEN:API_TOKEN,accessorinfo:info};sendMessageToFrame(msg)}function sendMessageToFrame(c){if(!c){return}try{console.log("sendMessageToFrame:",c);let win=document.getElementsByTagName("iframe")[0].contentWindow;win.postMessage(JSON.stringify(c),"*")}catch(b){console.log(b)}}function serializeToJSON(b){let json={};if(b){let formarray=Array.isArray(b)?b:$(b).serializeArray();formarray.forEach(function(f,c){let name=f.name;if(json.hasOwnProperty(name)){let arr=json[name];if(Array.isArray(arr)){arr.push(f.value)}else{json[name]=[arr,f.value]}}else{json[name]=f.value}})}return json}function serializeDataForm(c,f,b){return serializeParameters(serializeToJSON(c),serializeToJSON(f),b)}function serializeParameters(f,b,c){if(b){Object.assign(f,b)}let jsondata={};let cipherdata=false;if(c||fs_default_raw_parameters){jsondata=f}else{let dh=getDH();if(dh){cipherdata=true;jsondata.ciphertext=dh.encrypt(JSON.stringify(f))}else{jsondata=f}}console.log("serialize: parameters",f);console.log("serialize: jsondata",jsondata);return{cipherdata:cipherdata,jsondata:jsondata,headers:{"data-type":cipherdata?"json/cipher":"",language:fs_default_language}}}function decryptCipherData(c,b){let accepttype=c["accept-type"];let dh=getDH();if(accepttype=="json/cipher"){let json=$.parseJSON(b);if(dh&&json.body.data&&typeof json.body.data==="string"){let jsondatatext=dh.decrypt(json.body.data);console.log("jsondatatext",jsondatatext);let jsondata=$.parseJSON(jsondatatext);json.body=jsondata;return json}}if(accepttype=="text/cipher"){let jsontext=dh.decrypt(b);console.log("jsontext",jsontext);if(jsontext){let json=$.parseJSON(jsontext);return json}}return b};